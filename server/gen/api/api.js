// Generated by CoffeeScript 1.3.3
(function() {
  var config, create_me_programs, db, nano, program, program1, program2, programs;

  config = require('../config');

  nano = require('nano')(config.db.endpoint);

  db = nano.use(config.db.name);

  /*
      PUT request
          requires _id and _rev
          returns rev in header (needs to update in model)
      POST request
          returns id and rev
      GET request
          returns _id and _rev
  */


  exports.login = function(req, res) {};

  exports.get_users = function(req, res) {};

  exports.get_user = function(req, res) {};

  exports.create_user = function(req, res) {};

  exports.get_me = function(req, res) {};

  exports.get_me_programs = function(req, res) {
    return db.view('programs', 'list', function(err, body) {
      var program, programs, r, _i, _len, _ref;
      if (!err && body.rows.length > 0) {
        console.log(body);
        programs = [];
        _ref = body.rows;
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          r = _ref[_i];
          program = r.value;
          program['id'] = program['_id'];
          program['rev'] = program['_rev'];
          programs.push(program);
        }
        return res.send(programs);
      } else {
        return res.send(err);
      }
    });
  };

  exports.create_me_programs = create_me_programs = function(req, res) {
    return db.insert(req.body, function(err, header, body) {
      if (!err) {
        console.log('POST PROGRAM');
        console.log(header);
        return res.send(header);
      }
    });
  };

  exports.edit_program = function(req, res) {
    console.log('PUT PROGRAM');
    return create_me_programs(req, res);
  };

  exports.delete_program = function(req, res) {
    console.log('DELETING PROGRAM');
    return db.destroy(req.params.id, req.headers['if-match'], function(err, body) {
      if (!err) {
        console.log(body);
        return res.send(body);
      } else {
        return console.log(err);
      }
    });
  };

  exports.get_programs = function(req, res) {};

  exports.get_program = function(req, res) {};

  program = function() {
    return {
      "created_at": "2012-07-10 10:24:03",
      "id": 3,
      "main_program": true,
      "name": "Summer 2012 workout program",
      "privacy": 2,
      "user_id": 3,
      "splits": [
        {
          "id": 4,
          "name": "Chest",
          "position": 1,
          "weights": [
            {
              "id": 5,
              "name": "Incline bench press",
              "position": 1,
              "comment": "Can definitely increase weight next time",
              "sets": [
                {
                  "id": 6,
                  "set": 2,
                  "weight": 150,
                  "lbkg": 'lbs',
                  "rep": 3,
                  "position": 1
                }, {
                  "id": 7,
                  "set": 1,
                  "weight": 160,
                  "lbkg": 'kg',
                  "rep": 3,
                  "position": 2
                }
              ]
            }, {
              "id": 8,
              "name": "Flat bench press",
              "position": 2,
              "comment": "",
              "sets": [
                {
                  "id": 9,
                  "set": 3,
                  "weight": 175,
                  "lbkg": 'lbs',
                  "rep": 3,
                  "position": 1
                }
              ]
            }, {
              "id": 10,
              "name": "Barbell row",
              "position": 3,
              "comment": "",
              "sets": [
                {
                  "id": 11,
                  "set": 3,
                  "weight": 180,
                  "lbkg": 'lbs',
                  "rep": 5,
                  "position": 1
                }
              ]
            }, {
              "id": 12,
              "name": "Weighted pull ups",
              "position": 4,
              "comment": "",
              "sets": [
                {
                  "id": 13,
                  "set": 2,
                  "weight": 60,
                  "lbkg": 'lbs',
                  "rep": 8,
                  "position": 1
                }, {
                  "id": 14,
                  "set": 1,
                  "weight": 45,
                  "lbkg": 'lbs',
                  "rep": 7,
                  "position": 2
                }
              ]
            }
          ]
        }, {
          "id": 15,
          "name": "Shoulder",
          "position": 2,
          "weights": [
            {
              "id": 16,
              "name": "Seated Shoulder Press",
              "position": 1,
              "comment": "",
              "sets": [
                {
                  "id": 17,
                  "set": 3,
                  "weight": 105,
                  "lbkg": 'lbs',
                  "rep": 6,
                  "position": 1
                }
              ]
            }, {
              "id": 18,
              "name": "Dumbbell Press",
              "position": 2,
              "comment": "",
              "sets": [
                {
                  "id": 19,
                  "set": 3,
                  "weight": 45,
                  "lbkg": 'lbs',
                  "rep": 6,
                  "position": 1
                }
              ]
            }, {
              "id": 20,
              "name": "Lateral raises",
              "position": 3,
              "comment": "Hurt my wrist during this exercise",
              "sets": [
                {
                  "id": 21,
                  "set": 2,
                  "weight": 25,
                  "lbkg": 'lbs',
                  "rep": 6,
                  "position": 1
                }, {
                  "id": 22,
                  "set": 1,
                  "weight": 10,
                  "lbkg": 'lbs',
                  "rep": 5,
                  "position": 2
                }
              ]
            }, {
              "id": 23,
              "name": "Barbell front raise",
              "position": 4,
              "comment": "",
              "sets": [
                {
                  "id": 24,
                  "set": 2,
                  "weight": 50,
                  "lbkg": 'lbs',
                  "rep": 6,
                  "position": 1
                }
              ]
            }
          ]
        }
      ]
    };
  };

  program1 = new program();

  program2 = new program();

  program2.id = 2;

  program2.name = 'Test Program';

  programs = [program1, program2];

}).call(this);
